# Прогнозирование заказов такси

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Построить модель для такого предсказания.

## Цель исследования

Построить модель для такого предсказания.

## Исходные данные

Данные представлены количеством заказов за каждые 10 минут в течении 5 месяцев.

## Итоги исследования

Во время проекты были загружены данные и выполнено их ресемплирование по одному часу. Они были проанализированы. Обучены разные модели с различными гиперпараметрами. Проверена лучшая модель на тестовой выборке.

- Данные загружены с индексом времени и отсортированы по данному индексу, пропущенных значений не было.
- Наблюдается тренд на увеличение количества заказов на данном периоде времени. 
- Присутствует суточная сезонность с пиками заказов около 12 часов ночи, также пики наблюдаются в часы пик (в 9-10 утра и 5 вечера). Резкий спад идет к раннему утру (около 5-7 утра) и после часа пик в 6 вечера.
- По сглаживанию скользящим средним, можно предположить, что ряд нестационарен, так как оно увеличивается со временем. Также это подтверждает тест Дики-Фуллера с уровнем значимости 1% (нулевая гипотеза не отвергнута – временной ряд нестационарен). 
- Написана функция для добавления признаков для будущего обучения модели, где выделены: год, день, день недели, час, отстающие значения и скользящее среднее со смещением.

1. Хорошо себя показали модели LGBM (с оценкой на кросс-валидации = 27.05 и гипермараметрами *depth=25* и *learning_rate = 0.1*) и XGBoost (с оценкой на кросс-валидации = 26.82 и гипермараметрами *max_depth = 3*, *learning_rate = 0.1* и *n_estimators = 400*). 
2. DecisionTree	показал наихудший результат на кросс-валидации = 31.22.
3. Лучше всего с оценкой на кросс-валидации = 26.58 показала модель CatBoost.


Лучшей моделью стала **CatBoost.** с RMSE равной 41.43 и параметрами *depth=25* и *learning_rate = 0.1*. Проверку на адекватность модель также прошла успешно (по предсказаниям по среднему значения тренировочной выборки RMSE = 84.76, а по константе = 150, RMSE = 59.72). В среднем модель хорошо показывает себя по сравнению с фактическими значениями, наблюдатаются отклонения в значениях в пиковых моментах. Когда сильных отклонений нет - предсказания больше совпадают с фактическими.

## Используемый стек

Jupyter Notebook

Python - pandas, numpy, matplotlib, sklearn, statsmodels, lightgbm, xgboost, catboost
